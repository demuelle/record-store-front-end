import service from './service';

function EncounterCard({ encounter, notify }) {
  function handleDelete() {
    service
      .deleteEncounterById(encounter.id)
      .then(() => notify({ action: 'delete', encounter }))
      .catch(err => notify({ action: 'delete', error: err.toString() }));
  }

  return (
    <div className="col">
      <div className="card">
        <div className="card-header">{encounter.brief}</div>
        {encounter.imageUrl && (
          <img
            src={encounter.imageUrl}
            className="card-img-top"
            alt={encounter.brief}
          />
        )}
        <div className="card-body">
          <h5>Timestamp</h5>
          <p className="card-text">{encounter.dateTime}</p>
          <h5>Details</h5>
          <p className="card-text">{encounter.details}</p>
          <h5>Investigators</h5>
          <ul>
            {encounter.investigators.map(i => (
              <li key={i.id}>{`${i.firstName} ${i.lastName}`}</li>
            ))}
          </ul>
        </div>
        <div className="card-footer d-flex justify-content-center">
          <button className="btn btn-danger mr-3" onClick={handleDelete}>
            Delete
          </button>
          <button
            className="btn btn-secondary"
            onClick={() => notify({ action: 'edit-form', encounter })}
          >
            Edit
          </button>
        </div>
      </div>
    </div>
  );
}

export default EncounterCard;
