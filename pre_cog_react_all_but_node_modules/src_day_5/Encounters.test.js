import { act, render } from '@testing-library/react';
import Encounters from './Encounters';

const encounters = [
  {
    id: 1,
    brief: 'Tingling sensation',
    details: 'I swear something is near me. I just know it.',
    dateTime: '19-Feb-2021 11:35AM',
    imageUrl: 'http://example.com/path/to/an/image.png',
    investigators: [
      { id: 1, firstName: 'Koo', lastName: 'Artaern' },
      { id: 3, firstName: 'Monto', lastName: 'Caarew' },
    ],
  },
  {
    id: 2,
    brief: 'Tingling sensation',
    details: 'I swear something is near me. I just know it.',
    dateTime: '19-Feb-2021 11:35AM',
    imageUrl: 'http://example.com/path/to/an/image.png',
    investigators: [
      { id: 1, firstName: 'Koo', lastName: 'Artaern' },
      { id: 3, firstName: 'Monto', lastName: 'Caarew' },
    ],
  },
];

test('should render 2 encounters', async () => {
  jest.spyOn(global, 'fetch').mockImplementation(() =>
    Promise.resolve({
      status: 200,
      json: () => Promise.resolve(encounters),
    })
  );

  let result;
  await act(async () => {
    result = render(<Encounters role="ROLE_USER" />);
  });

  const headers = result.baseElement.querySelectorAll('.card-header');
  expect(headers.length).toBe(2);
});
